<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Primera practica VUE</title>
    <style>
        body {
            background-color: rgb(221, 161, 133);
        }

        table.customTable {
            width: 100%;
            background-color: #FFFFFF;
            border-collapse: collapse;
            border-width: 2px;
            border-color: #ff5100;
            border-style: solid;
            color: #000000;
        }

        table.customTable td,
        table.customTable th {
            border-width: 2px;
            border-color: #000000;
            border-style: solid;
            padding: 5px;
        }

        table.customTable thead {
            background-color: #ff5100;
        }
    </style>
</head>

<body>
    <div class="container" id="container">
        <!-- <h1> Buenas días {{ name }} </h1>

        <input type="text" v-model="name" name="">

        <br><br>

        <button @click="count++">
            Count is: {{ count }}
        </button>

        <br><br>

        <input type="" v-model="numero1"> <br>
        <input type="" v-model="numero2"> <br>
        <br>

        <button @click="result=((+numero1)+(+numero2))">
            Suma
        </button>

        <h3>Resultado: <span v-if="result!=0"> {{ result }}</span> </h3><br> -->

        <form v-if="!is_Login">

            <fieldset>
                <legend>
                    Email
                </legend>
                <input type="text" v-model="email" name="">
                <legend>
                    Contraseña
                </legend>
                <input type="password" v-model="password" name="">
                <br>
            </fieldset>
            <br>
            <button type="button" @click="login">Anexarme</button>

        </form>

        <table class="customTable" v-if="is_Login">


            <thead>
                <tr>
                    <th>Datos personales</th>
                    <th>Correo</th>
                    <th>Telefono</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="u in user_r">
                    <td> {{u.name}} {{u.lastname}} </td>
                    <td> {{u.email}} </td>
                    <td> {{u.phone}} </td>
                </tr>
            </tbody>
        </table>
        <!-- Generated at CSSPortal.com -->


    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script type="text/javascript">
        const { createApp, ref } = Vue

        createApp({
            setup() {

                const users = ref([]);
                const email = ref("fabianramirez2810@gmail.com");
                const password = ref("123456");

                let temp = localStorage.getItem("is_Login");
                if(temp == null){
                    temp = false;
                }
                is_Login = ref(temp);

                return {
                    users,
                    email,
                    password,
                    is_Login
                }
            },
            mounted: function(){
                const getUsers = async () => {
                    const response = await fetch("user.json");
                    const tmp_users = await response.json();
                    this.user_r = tmp_users;
                }
                if(this.is_Login){
                    getUsers();
                }

            },
            methods: {
                async login() {

                    const response = await fetch("user.json");
                    this.user_r = await response.json();
                    this.is_Login = false;

                    this.user_r.forEach(element => {
                        if (this.email == element.email) {
                            if (this.password == element.password) {
                                this.is_Login = true;
                                alert("Buenas buenas ");

                                localStorage.setItem("user_data", JSON.stringify(element));
                                localStorage.setItem("is_login", "true");
                                
                            }
                        }

                    });
                    if (!this.is_Login) {
                        alert("Verifique su informacion");
                    }
                    
                },
                update(user_r){
                    this.user_r = user_r;
                }

            }
        }).mount('#container')
    </script>
</body>

</html>